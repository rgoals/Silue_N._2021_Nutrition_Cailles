[["teneur-en-lipides-des-oeufs.html", "Chapitre 17 Teneur en lipides des oeufs 17.1 Les données 17.2 Visualisation boxplots 17.3 Détection des observations aberrantes extrêmes 17.4 Conditions de lANOVA 17.5 ANOVA", " Chapitre 17 Teneur en lipides des oeufs La démarche sera la même que celle des chapitres précédents. Il se peut quil y ait moins de commentaires. Même jeu de données oeuf.csv qui contient différentes mesures dont la teneur en lipides totaux de loeuf, mesurée en 1 séance. Mêmes traitements (régimes). La question est de savoir si les différents régimes induisent des teneurs en lipides totaux des oeufs significativement différents. 17.1 Les données lip &lt;- read_csv(&quot;data/oeuf.csv&quot;) lip &lt;- lip %&gt;% select(seance, regime, no_oeuf, lip_tot) %&gt;% mutate(id = rep(1:30, 5), .before = 1) %&gt;% convert_as_factor(id, seance, regime) %&gt;% filter(seance == &quot;seance 1&quot;) glimpse(lip) ## Rows: 30 ## Columns: 5 ## $ id &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,~ ## $ seance &lt;fct&gt; seance 1, seance 1, seance 1, seance 1, seance 1, seance 1, se~ ## $ regime &lt;fct&gt; &quot;Ba 0,25&quot;, &quot;Ba 0,25&quot;, &quot;Ba 0,25&quot;, &quot;Ba 0,50&quot;, &quot;Ba 0,50&quot;, &quot;Ba 0,5~ ## $ no_oeuf &lt;dbl&gt; 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3,~ ## $ lip_tot &lt;dbl&gt; 56.4, 52.4, 68.4, 70.2, 70.2, 57.2, 68.0, 46.6, NA, 66.4, 56.8~ 17.2 Visualisation boxplots bxp &lt;- ggplot(lip, aes(x = regime, y = lip_tot, fill = regime)) + geom_boxplot() + facet_grid(seance ~ .) + theme(axis.text.x = element_text(angle = 90, color = &quot;blipk&quot;, vjust = 0.5, hjust = 1)) + ylab(&quot;Teneur en lipides totaux de l&#39;oeuf&quot;) + theme_bw() bxp ## Warning: Removed 3 rows containing non-finite values (stat_boxplot). =&gt; Variations notables entre les traitements. 17.3 Détection des observations aberrantes extrêmes lip_out &lt;- lip %&gt;% identify_outliers(lip_tot) lip_out ## [1] id seance regime no_oeuf lip_tot is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) =&gt; Pas dobservations aberrantes extrêmes. 17.4 Conditions de lANOVA 17.4.1 Normalité Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05 pour chaque régime. lip %&gt;% shapiro_test(lip_tot) ## # A tibble: 1 x 3 ## variable statistic p ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 lip_tot 0.978 0.816 =&gt; Normalité Okay. Mais on verra bien le comportement des résidus de lANOVA. Créer des QQ-plots pour chaque point par séance ggqqplot(lip, &quot;lip_tot&quot;)#, facet.by = &quot;seance&quot;) 17.4.2 Homogénéité des variances lip %&gt;% levene_test(lip_tot ~ regime) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 9 17 0.735 0.673 =&gt; Valeur-p &gt; 0.05 =&gt; variances homogènes. 17.5 ANOVA 17.5.1 Le modèle lm &lt;- lm(lip_tot ~ regime, data = lip) Anova(lm) ## Anova Table (Type II tests) ## ## Response: lip_tot ## Sum Sq Df F value Pr(&gt;F) ## regime 872.25 9 1.7694 0.1487 ## Residuals 931.15 17 La p-value &gt; 0.05 =&gt; pas de différence significative entre les effets des régimes sur la teneur en protéines. shapiro_test(residuals(lm)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm) 0.973 0.680 =&gt; Normalité Okay. 17.5.1.1 Comparaisons par paires cm &lt;- (SNK.test(lm, &quot;regime&quot;, group = TRUE))$groups %&gt;% mutate(regime = rownames(.)) %&gt;% select(regime, lip_tot, groups) %&gt;% as_tibble() cm ## # A tibble: 10 x 3 ## regime lip_tot groups ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Ba 5 78.6 a ## 2 Ba 10 69.8 a ## 3 Ba 0,50 65.9 a ## 4 WC 65.6 a ## 5 Ba 1 64.5 a ## 6 Ba 2,5 63.9 a ## 7 YC 63.5 a ## 8 Ba 7,5 60.5 a ## 9 Ba 0,25 59.1 a ## 10 Ba 0,75 57.3 a ggplot(data = cm, mapping = aes(x = regime, y = lip_tot)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + #ylim(0, 80) + geom_text(aes(label = groups), vjust = -0.5, size = 4) + xlab(&quot;Régimes&quot;) + ylab(&quot;Teneur en lipides totaux de l&#39;oeuf&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() "]]
