--- 
title: "Exploration de données, nutrition de cailles"
author: "Silué Nahoulé"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
#bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
description: "Analyses exploratoires"
---

# Gain moyen quotidien {#gmq}

## Les librairies

```{r message = FALSE, warning = FALSE}
library("tidyverse") # tidy et ggplot2
library("ggpubr")      # 
library("agricolae") # SNK.test() Student Newman-Keuls
library("car")       # leveneTest()
library("rstatix")   # convert_as_factor(), friedman_test()
```

## Les données

```{r}
dgmq <- read_csv("data/gmq.csv")
dgmq <- dgmq %>%
  convert_as_factor(regime)
```

## Visualisation, boxplots

```{r}
ggplot(data = dgmq, aes(x = regime, y = gmq)) +
  geom_boxplot() + 
  #theme_classic() +
  xlab("Régimes") + ylab("Gain moyen quotidien") +
  theme(axis.text.x = element_text(angle = 45, color = "black", vjust = 1, hjust = 1))
```

## Vérification des conditions de l'ANOVA

### Normalité

Test de significativité comparant la distribution de l’échantillon à une distribution normale afin de déterminer si les données montrent ou non un écart important par rapport à la distribution normale.

Il existe plusieurs méthodes pour évaluer la normalité, notamment le **test de normalité de Kolmogorov-Smirnov** (K-S) et le **test de Shapiro-Wilk**.

- Ho. la distribution de l’échantillon est normale (ou n'est pas différente d'une distribution normale).

Si **p-value > 0,05** alors la distribution des données n’est pas significativement différente de la distribution normale. On accepte Ho.

```{r}
dgmq %>%
  shapiro_test(gmq)
```

> p-value > 0.05, alors distribution normale

### Homogénéité des variances, test de Levene

Pour ces tests :

- `Ho`. Toutes les variances des populations (traitements) sont égales.
- `H1` ou `Ha`. Au moins deux d'entre elles diffèrent.

Par conséquent, des valeurs p inférieures à 0,05 suggèrent que les variances sont significativement différentes et donc que l'hypothèse d'homogénéité des variances n'est pas respectée.

```{r}
levene_test(gmq ~ regime, data = dgmq)
```

> p-value < 0.05 => Variances non homogènes => Alternative non paramétrique : Test de Kruskal-Wallis recommandé lorsque les hypothèses du test ANOVA à un facteur ne sont pas respectées.

### Alternative non paramétrique, test de Kruskal-Wallis

```{r}
dgmq %>% 
  kruskal_test(gmq ~ regime)
```

> p-value < 0.05 => Différence significative entre les effets d'au moins 2 régimes.

Un test de Kruskal-Wallis significatif est généralement suivi d’un test de Dunn pour identifier les groupes différents. Le test de Dunn tient compte du classement utilisé par le test de Kruskal-Wallis. Il fait aussi des ajustements pour les exaequos.

### Comparaisons par paires, test de Dunn 

Pour identifier les groupes différents. 

```{r}
dgmq %>% 
  dunn_test(gmq ~ regime, p.adjust.method = "bonferroni") %>% 
  select(group1, group2, p, p.adj, p.adj.signif) %>% 
  filter(p.adj.signif != "ns")
```

> Sont les paires de régimes dont les effets sur le GMQ sont significativement différents.

Calcul des moyennes ci-dessous, pour le classement manuel (identifier les groupes). Le graphique automatique un peu complexe !

```{r}
dgmq %>% 
  select(regime, gmq) %>% 
  group_by(regime) %>% 
  summarise_all(list(gmq_moyen = mean, sd = sd))
```
