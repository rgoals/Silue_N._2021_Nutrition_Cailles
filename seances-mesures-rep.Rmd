# Les séances, en mesures répétées {#mesrep}

```{r message = FALSE, warning = FALSE}
library("tidyverse") # tidy et ggplot2
library("ggpubr")      # 
library("agricolae") # SNK.test() Student Newman-Keuls
library("car")       # leveneTest()
library("rstatix")   # convert_as_factor(), friedman_test()
```

## LES DONNÉES

Ajout d'un identifiant (`ID`) pour faire correspondre les individus par séance.

```{r}
df <- read_csv("data/seance.csv")
df <- df %>%
  mutate(ID = rep(1:30, 5)) %>% 
  convert_as_factor(ID, regime, seance) 
```

Les tableaux sont conçus depuis Excel en format long.

## MASSE DES OEUFS

### Sommaire par séance, masse des oeufs

```{r}
df %>%
  select(seance, regime, masse_oeuf) %>% 
  group_by(seance) %>%
  get_summary_stats(masse_oeuf, type = "mean_sd")
```

### Visualisation boxplots, masse des oeufs

```{r}
df %>%
  select(seance, regime, masse_oeuf) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "masse_oeuf")#, add = "point")
```

### Normalité, masse des oeufs

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, masse_oeuf) %>% 
  group_by(seance) %>%
  shapiro_test(masse_oeuf)
```

> Distribution non-normale pour la séance 2 => Alternative : Test de Friedman pour mésures repétées, bien que les variances soient homogènes.

```{r}
df %>%
  select(seance, regime, masse_oeuf) %>% 
  levene_test(masse_oeuf ~ seance)
```

### Test de Friedman, masse des oeufs

```{r}
tf_mo <- df %>%
  select(ID, seance, masse_oeuf) %>% 
  friedman_test(masse_oeuf ~ seance |ID)
tf_mo
```

> La masse des oeufs n'est pas statistiquement significativement différente aux différents temps (différentes séances) durant cette étude.


***

## MASSE DE LA COQUILLE

### Sommaire par séance, masse de la coquille

```{r}
df %>%
  select(seance, regime, masse_coq) %>% 
  group_by(seance) %>%
  get_summary_stats(masse_coq, type = "mean_sd")
```

### Visualisation boxplots, masse de la coquille

```{r}
df %>%
  select(seance, regime, masse_coq) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "masse_coq")#, add = "point")
```

### Normalité, masse de la coquille

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, masse_coq) %>% 
  group_by(seance) %>%
  shapiro_test(masse_coq)
```

> Distribution non-normale pour la séance 4 => Alternative : Test de Friedman pour mésures repétées, bien que les variances soient homogènes :

```{r}
df %>%
  select(seance, regime, masse_coq) %>% 
  levene_test(masse_coq ~ seance)
```

### Test de Friedman, masse de la coquille

```{r}
tf_mc <- df %>%
  select(ID, seance, masse_coq) %>% 
  friedman_test(masse_coq ~ seance |ID)
tf_mc
```

> La masse de la coquille est statistiquement très significativement différente entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_mc <- df %>%
  select(ID, seance, masse_coq) %>%
  wilcox_test(masse_coq ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_mc
```

> séance 1 et séance 5
> séance 2 et séance 4
> séance 3 et séance 4
> séance 4 et séance 5
> sont significativement différentes.

### Visualisation : Boxplots avec p-values

```{r}
pwc_mc <- pwc_mc %>% add_xy_position(x = "seance")

ggboxplot(df, x = "seance", y = "masse_coq", add = "point") +
  stat_pvalue_manual(pwc_mc, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(tf_mc, detailed = TRUE),
    caption = get_pwc_label(pwc_mc)
  )
```


***

## ÉPAISSEUR DE LA COQUILLE

### Sommaire par séance, épaisseur de la coquille

```{r}
df %>%
  select(seance, regime, epaisseur_coq) %>% 
  group_by(seance) %>%
  get_summary_stats(epaisseur_coq, type = "mean_sd")
```

### Visualisation boxplots, épaisseur de la coquille

```{r}
df %>%
  select(seance, regime, epaisseur_coq) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "epaisseur_coq")#, add = "point")
```

### Normalité, épaisseur de la coquille

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, epaisseur_coq) %>% 
  group_by(seance) %>%
  shapiro_test(epaisseur_coq)
```

> Distribution non-normale pour les séances 1 et 4 => Alternative : Test de Friedman pour mésures repétées, bien que les variances soient homogènes :

```{r}
df %>%
  select(seance, regime, epaisseur_coq) %>% 
  levene_test(epaisseur_coq ~ seance)
```

### Test de Friedman, épaisseur de la coquille

```{r}
tf_ec <- df %>%
  select(ID, seance, epaisseur_coq) %>% 
  friedman_test(epaisseur_coq ~ seance |ID)
tf_ec
```

> La masse de la coquille est statistiquement très significativement différente entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_ec <- df %>%
  select(ID, seance, masse_coq) %>%
  wilcox_test(masse_coq ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_ec
```

> séance 1 et séance 5
> séance 2 et séance 4
> séance 3 et séance 4
> séance 4 et séance 5
> sont significativement différentes.

***

## MASSE DU JAUNE

### Sommaire par séance, masse du jaune

```{r}
df %>%
  select(seance, regime, masse_du_jaune) %>% 
  group_by(seance) %>%
  get_summary_stats(masse_du_jaune, type = "mean_sd")
```

### Visualisation boxplots, masse du jaune

```{r}
df %>%
  select(seance, regime, masse_du_jaune) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "masse_du_jaune")#, add = "point")
```

### Normalité, masse du jaune

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, masse_du_jaune) %>% 
  group_by(seance) %>%
  shapiro_test(masse_du_jaune)
```

> Distribution non-normale pour les séances 1 et 5 => Alternative : Test de Friedman pour mésures repétées, bien que les variances soient homogènes :

```{r}
df %>%
  select(seance, regime, masse_du_jaune) %>% 
  levene_test(masse_du_jaune ~ seance)
```

### Test de Friedman, masse du jaune

```{r}
tf_mj <- df %>%
  select(ID, seance, masse_du_jaune) %>% 
  friedman_test(masse_du_jaune ~ seance |ID)
tf_mj
```

> La masse du jaune d'oeuf n'est pas statistiquement différente entre les différentes séances de mesure.


***

## MASSE DU BLANC

### Sommaire par séance, masse du blanc

```{r}
df %>%
  select(seance, regime, masse_du_blanc) %>% 
  group_by(seance) %>%
  get_summary_stats(masse_du_blanc, type = "mean_sd")
```

### Visualisation boxplots, masse du blanc

```{r}
df %>%
  select(seance, regime, masse_du_blanc) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "masse_du_blanc")#, add = "point")
```

### Normalité, masse du blanc

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, masse_du_blanc) %>% 
  group_by(seance) %>%
  shapiro_test(masse_du_blanc)
```

> Distribution non-normale pour les séances 2 et 5 => Alternative : Test de Friedman pour mésures repétées, bien que les variances soient homogènes :

```{r}
df %>%
  select(seance, regime, masse_du_blanc) %>% 
  levene_test(masse_du_blanc ~ seance)
```

### Test de Friedman, masse du blanc

```{r}
tf_mb <- df %>%
  select(ID, seance, masse_du_blanc) %>% 
  friedman_test(masse_du_blanc ~ seance |ID)
tf_mb
```

> La masse du blanc d'oeuf n'est pas statistiquement différente entre les différentes séances de mesure.


***

## INDICE 'l' INTÉRIEUR DE LA COQUILLE

### Sommaire par séance, indice 'l' intérieur coquille

```{r}
df %>%
  select(seance, regime, l_int_coq) %>% 
  group_by(seance) %>%
  get_summary_stats(l_int_coq, type = "mean_sd")
```

### Visualisation boxplots, indice 'l' intérieur coquille

```{r}
df %>%
  select(seance, regime, l_int_coq) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "l_int_coq")#, add = "point")
```

### Normalité, indice 'l' intérieur coquille

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, l_int_coq) %>% 
  group_by(seance) %>%
  shapiro_test(l_int_coq)
```

> Distribution non-normale pour toutes les séances sauf la 4 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, l_int_coq) %>% 
  levene_test(l_int_coq ~ seance)
```

### Test de Friedman, indice 'l' intérieur coquille

```{r}
tf_lic <- df %>%
  select(ID, seance, l_int_coq) %>% 
  friedman_test(l_int_coq ~ seance |ID)
tf_lic
```

> Cet indice est statistiquement très significativement différente entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_lic <- df %>%
  select(ID, seance, l_int_coq) %>%
  wilcox_test(l_int_coq ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_lic
```

> séance 1 et séance 3
> séance 2 et séance 3
> séance 3 et séance 4
> séance 3 et séance 5
> sont significativement différentes.

***

## INDICE 'a' INTÉRIEUR DE LA COQUILLE

### Sommaire par séance, indice 'a' intérieur coquille

```{r}
df %>%
  select(seance, regime, a_int_coq) %>% 
  group_by(seance) %>%
  get_summary_stats(a_int_coq, type = "mean_sd")
```

### Visualisation boxplots, indice 'a' intérieur coquille

```{r}
df %>%
  select(seance, regime, a_int_coq) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "a_int_coq")#, add = "point")
```

### Normalité, indice 'a' intérieur coquille

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, a_int_coq) %>% 
  group_by(seance) %>%
  shapiro_test(a_int_coq)
```

> Distribution non-normale pour les séances 1, 3 et 5 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, a_int_coq) %>% 
  levene_test(a_int_coq ~ seance)
```

### Test de Friedman, indice 'a' intérieur coquille

```{r}
tf_aic <- df %>%
  select(ID, seance, a_int_coq) %>% 
  friedman_test(a_int_coq ~ seance |ID)
tf_aic
```

> Cet indice est statistiquement très significativement différent entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_aic <- df %>%
  select(ID, seance, a_int_coq) %>%
  wilcox_test(a_int_coq ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_aic
```

> séance 3 et séance 4
> séance 3 et séance 5
> sont significativement différentes.


***

## INDICE 'b' INTÉRIEUR DE LA COQUILLE

### Sommaire par séance, indice 'b' intérieur coquille

```{r}
df %>%
  select(seance, regime, b_int_coq) %>% 
  group_by(seance) %>%
  get_summary_stats(b_int_coq, type = "mean_sd")
```

### Visualisation boxplots, indice 'b' intérieur coquille

```{r}
df %>%
  select(seance, regime, b_int_coq) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "b_int_coq")#, add = "point")
```

### Normalité, indice 'b' intérieur coquille

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, b_int_coq) %>% 
  group_by(seance) %>%
  shapiro_test(b_int_coq)
```

> Distribution non-normale pour toutes les séances => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, b_int_coq) %>% 
  levene_test(b_int_coq ~ seance)
```

### Test de Friedman, indice 'b' intérieur coquille

```{r}
tf_bic <- df %>%
  select(ID, seance, b_int_coq) %>% 
  friedman_test(b_int_coq ~ seance |ID)
tf_bic
```

> Cet indice est statistiquement très significativement différent entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_bic <- df %>%
  select(ID, seance, b_int_coq) %>%
  wilcox_test(b_int_coq ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_bic
```

> Séances toutes significativement différentes sauf la 4 et la 5 .


***

## INDICE 'l' DU JAUNE D'OEUF

### Sommaire par séance, indice 'l' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, l_jaune) %>% 
  group_by(seance) %>%
  get_summary_stats(l_jaune, type = "mean_sd")
```

### Visualisation boxplots, indice 'l' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, l_jaune) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "l_jaune")#, add = "point")
```

### Normalité, indice 'l' du jaune d'oeuf

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, l_jaune) %>% 
  group_by(seance) %>%
  shapiro_test(l_jaune)
```

> Distribution non-normale pour les séances 1, 2 et 3 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, l_jaune) %>% 
  levene_test(l_jaune ~ seance)
```

### Test de Friedman, indice 'l' du jaune d'oeuf

```{r}
tf_lj <- df %>%
  select(ID, seance, l_jaune) %>% 
  friedman_test(l_jaune ~ seance |ID)
tf_lj
```

> Cet indice est statistiquement très significativement différente entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_lj <- df %>%
  select(ID, seance, l_jaune) %>%
  wilcox_test(l_jaune ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_lj
```

```{r}
df %>%
  select(seance, regime, l_jaune) %>% 
  group_by(seance) %>%
  get_summary_stats(l_jaune, type = "mean")
```

> séance 1 et séance 2
> séance 1 et séance 3
> séance 1 et séance 4
> séance 3 et séance 5
> sont significativement différentes.

***


## INDICE 'a' DU JAUNE D'OEUF

### Sommaire par séance, indice 'a' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, a_jaune) %>% 
  group_by(seance) %>%
  get_summary_stats(a_jaune, type = "mean_sd")
```

### Visualisation boxplots, indice 'a' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, a_jaune) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "a_jaune")#, add = "point")
```

### Normalité, indice 'a' du jaune d'oeuf

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, a_jaune) %>% 
  group_by(seance) %>%
  shapiro_test(a_jaune)
```

> Distribution non-normale pour les séances 1 et 2 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, a_jaune) %>% 
  levene_test(a_jaune ~ seance)
```

### Test de Friedman, indice 'a' du jaune d'oeuf

```{r}
tf_aj <- df %>%
  select(ID, seance, a_jaune) %>% 
  friedman_test(a_jaune ~ seance |ID)
tf_aj
```

> Les comparaisons par paires aideront à conclure. Probablement pas de diiférences significatives ...

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon. 

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_aj <- df %>%
  select(ID, seance, a_jaune) %>%
  wilcox_test(a_jaune ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_aj
```

> Pas de différences significatives entre les séances.


***

## INDICE 'b' DU JAUNE D'OEUF

### Sommaire par séance, indice 'b' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, b_jaune) %>% 
  group_by(seance) %>%
  get_summary_stats(b_jaune, type = "mean_sd")
```

### Visualisation boxplots, indice 'b' du jaune d'oeuf

```{r}
df %>%
  select(seance, regime, b_jaune) %>% 
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "b_jaune")#, add = "point")
```

### Normalité, indice 'b' du jaune d'oeuf

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, b_jaune) %>% 
  group_by(seance) %>%
  shapiro_test(b_jaune)
```

> Distribution non-normale pour toutes les séances => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, b_jaune) %>% 
  levene_test(b_jaune ~ seance)
```

### Test de Friedman, indice 'b' du jaune d'oeuf

```{r}
tf_bj <- df %>%
  select(ID, seance, b_jaune) %>% 
  friedman_test(b_jaune ~ seance |ID)
tf_bj
```

> Cet indice est statistiquement très significativement différent entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

```{r}
pwc_bj <- df %>%
  select(ID, seance, b_jaune) %>%
  wilcox_test(b_jaune ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_bj
```

> Séance 1 différente des autres qui sont similaires.


***


## PROTÉINES TOTALES

### Sommaire par séance, protéines

```{r}
df %>%
  select(seance, regime, prot_tot) %>% 
  filter(seance != "seance 5") %>% 
  group_by(seance) %>%
  get_summary_stats(prot_tot, type = "mean_sd")
```

### Visualisation boxplots, protéines

```{r}
df %>%
  select(seance, regime, prot_tot) %>% 
  filter(seance != "seance 5") %>%
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "prot_tot")#, add = "point")
```

### Normalité, protéines

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, prot_tot) %>% 
  filter(seance != "seance 5") %>%
  group_by(seance) %>%
  shapiro_test(prot_tot)
```

> Distribution non-normale pour les séances 2 à 4 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, prot_tot) %>% 
  filter(seance != "seance 5") %>%
  levene_test(prot_tot ~ seance)
```

### Test de Friedman, protéines

``{r}
tf_pt <- df %>%
  select(ID, seance, prot_tot) %>% 
  filter(seance != "seance 5") %>%
  friedman_test(prot_tot ~ seance |ID)
tf_pt
``

> Cet indice est statistiquement très significativement différent entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

``{r}
pwc_pt <- df %>%
  select(ID, seance, prot_tot) %>%
  filter(seance != "seance 5") %>%
  wilcox_test(prot_tot ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_pt
``


***


## CHOLESTÉROL TOTAL

### Sommaire par séance, cholestérol

```{r}
df %>%
  select(seance, regime, chol_tot) %>% 
  filter(seance != "seance 5") %>% 
  group_by(seance) %>%
  get_summary_stats(chol_tot, type = "mean_sd")
```

### Visualisation boxplots, cholestérol

```{r}
df %>%
  select(seance, regime, chol_tot) %>% 
  filter(seance != "seance 5") %>%
  group_by(seance) %>%
  ggboxplot(x = "seance", y = "chol_tot")#, add = "point")
```

### Normalité, cholestérol

Si les données sont normalement distribuées, la p-value de Shapiro-Wilk doit être supérieure à 0,05.

```{r}
df %>%
  select(seance, regime, chol_tot) %>% 
  filter(seance != "seance 5") %>%
  group_by(seance) %>%
  shapiro_test(chol_tot)
```

> Distribution non-normale pour les séances 1 et 4 => Alternative : Test de Friedman pour mésures repétées,variances non-homogènes également :

```{r}
df %>%
  select(seance, regime, chol_tot) %>% 
  filter(seance != "seance 5") %>%
  levene_test(chol_tot ~ seance)
```

### Test de Friedman, cholestérol

``{r}
tf_cht <- df %>%
  select(ID, seance, chol_tot) %>% 
  filter(seance != "seance 5") %>%
  friedman_test(chol_tot ~ seance |ID)
tf_cht
``

> Cet indice est statistiquement très significativement différent entre certains temps (séances) durant cette étude.

### Comparaisons par paires à l’aide du test apparié des rangs signés de Wilcoxon

Les p-values sont ajustées à l’aide de la méthode de correction des tests multiples de Bonferroni.

``{r}
pwc_cht <- df %>%
  select(ID, seance, chol_tot) %>%
  filter(seance != "seance 5") %>%
  wilcox_test(chol_tot ~ seance, paired = TRUE, p.adjust.method = "bonferroni")
pwc_cht
``



## LIPIDES TOTALES

Pas analysés, seulement en une séance.


